<% layout("/layouts/boilerplate") %>

    <div class="row mt-3">
        <div class="col-8 offset-2">
            <h3>
                <%= one.title %>
            </h3>
        </div>

        <div class="card col-6 offset-3 show-card listing-card">
            <img src="<%= one.image.url %>" class="card-img-top show-img" alt="listing_image">
            <div class="card-body">
                <p class="card-text">
                    <br>
                    <%= one.description %> <br>
                        &#8377; <%= one.price.toLocaleString("en-IN") %> <br>
                            <%= one.location %> <br>
                                <%= one.country %>
                </p>
            </div>
        </div>

        <div class="btns mb-5 col-6 offset-3">
            <a href="/listings/<%= one._id %>/edit" class="btn btn-dark edit-btn">Edit</a>

            <form method="POST" action="/listings/<%=one._id%>?_method=DELETE" class="ms-3">
                <button class="btn btn-dark ">Delete</button>
            </form>
        </div>
      
      
      
        <div class="col-6 offset-3 mt-4">
  <div class="card shadow-sm p-4">
    <h4 class="mb-3">Leave a Review</h4>

    <form action="/listings/<%= one._id%>/reviews" method="POST" novalidate class="needs-validation">
      <!-- Rating --> 
      <div class="mb-3">
        <label for="rating" class="form-label">Rating (1–5)</label>
        <input 
          type="range" 
          class="form-range" 
          min="1" 
          max="5" 
          id="rating" 
          name="review[rating]">
      </div>

      <!-- Comment -->
      <div class="mb-3">
        <label for="comment" class="form-label">Comment</label>
        <textarea 
          class="form-control" 
          id="comment" 
          name="review[comment]" 
          rows="3"
          required
          placeholder="Write your experience..."></textarea>
           <div class="invalid-feedback">
        please add some comments for review
      </div>

      </div>
     
      <!-- Button -->
      <button class="btn btn-dark rounded-pill px-4">
        Submit
      </button>
    </form>
  </div>
</div>
<!-- <div>

        <h4>All Reviews:</h4>
        <ul>
        <% for(review of one.reviews){ %>
   

            <li> <%= review.comment %>, <%= review.rating %>stars </li>
               
    

  <%  }  %>

        </ul>
</div> -->


    <div class="col-6 offset-3 mt-4">
  <h4 class="mb-3">All Reviews:</h4>

  <% if(one.reviews.length === 0){ %>
    <p class="text-muted">No reviews yet.</p>
  <% } %>

  <% for(let review of one.reviews){ %>
    <div class="card mb-3 shadow-sm">
      <div class="card-body">
        <p class="mb-1">
          <strong><%= review.rating %>/5</strong> ⭐
        </p>
        <p class="mb-0 text-muted">
          <%= review.comment %>
        </p>
      </div>
      <form class="mb-3"method="POST" action="/listings/<%=one._id %>/delete/<%=review._id%>?_method=DELETE">
         <button class="btn btn-sm btn-dark">Delete Review</button>
      </form>
      
    </div>
  <% } %>
</div>

    </div>

  